<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <script src="./funcoes.js"></script>
    <link rel="shortcut icon" href="./Imagens/favicon.png" type="image/x-icon">
    <script src="//code-sa1.jivosite.com/widget/hRu2eHyOaC" async></script>
    <title>Perfil BandChess</title>
</head>
<body onload="verificar_autenticacaoPerfil()">
    <div class="bodyPerfil">
        <div class="navBar">
            <a href="index.html"><img src="./Imagens/index/Logo BandChess.png"></a>
            <ul>
                <a href="index.html">
                    <li>Home | </li>
                </a>
                <a href="aberturas.html">
                    <li> Aberturas | </li>
                </a>
                <a href="rankings.html">
                    <li class="navBarSelected"> Rankings | </li>
                </a>
                <a id="perfilUser" href="perfil.html">
                    <li id="b_usuario"></li>
                </a>
                <a>
                    <li onclick="logoff()">| Sair</li>
                </a>
            </ul>
        </div>
        <div class="containerLogin">
            <div class="conteudoLogin">
                <h1 id="nomeUsuario">Olá, <span id="b_usuarioDesempenho"></span></h1>
                <div class="sobre">
                    <span>Torneio Mais Recente: Copa Peao</span><br>
                    <span>Desempenho</span><br>
                    <span>Posição: 2º</span><br>
                    <span>Vitórias: 3</span><br>
                    <span>Empates: 0</span><br>
                    <span>Derrotas: 1</span><br>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
<script>
    function verificar_autenticacaoPerfil() {
        login_usuario = sessionStorage.login_usuario_meuapp;
        nome_usuario = sessionStorage.nome_usuario_meuapp;

        if (login_usuario == undefined) {
            console.log("Usuario não logado")
        }else if(login_usuario == 'adminBandChess@bandchess.com'){
            b_usuario.innerHTML = nome_usuario;
            b_usuarioDesempenho.innerHTML = nome_usuario;
            perfilUser.href = 'admin.html'
            validar_sessao();
        }else {
            b_usuario.innerHTML = nome_usuario;
            b_usuarioDesempenho.innerHTML = nome_usuario;
            validar_sessao();
        }
    }
    function validar_sessao() {
    fetch(`/usuarios/sessao/${login_usuario}`, {cache:'no-store'})
    .then(resposta => {
        if (resposta.ok) {
            resposta.text().then(texto => {
                console.log('Sessão :) ', texto);
            });
        } else {
            console.error('Sessão :.( ');
            logoff();
        } 
    });
}

</script>